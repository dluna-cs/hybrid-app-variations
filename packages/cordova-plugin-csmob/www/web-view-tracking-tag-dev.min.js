(()=>{"use strict";var t,e,n,r=function(){function t(){}return t.prototype.whenReady=function(t){var e=setInterval((function(){void 0!==window.CSJavascriptBridge&&(clearInterval(e),t())}),1e3)},t.prototype.optIn=function(){window.CSJavascriptBridge.optIn&&window.CSJavascriptBridge.optIn()},t.prototype.optOut=function(){window.CSJavascriptBridge.optOut&&window.CSJavascriptBridge.optOut()},t.prototype.sendEvent=function(t){window.CSJavascriptBridge.sendEvent(JSON.stringify(t))},t.prototype.sendException=function(t){window.CSJavascriptBridge.sendException(JSON.stringify(t))},t.prototype.sendMessage=function(t){window.CSJavascriptBridge.sendMessage(JSON.stringify(t))},t.prototype.sendDynamicVar=function(t,e){window.CSJavascriptBridge.sendDynamicVar&&window.CSJavascriptBridge.sendDynamicVar(t,e)},t.prototype.sendTransaction=function(t,e,n){window.CSJavascriptBridge.sendTransaction&&window.CSJavascriptBridge.sendTransaction(t,e,n)},t}();function i(t){return o(t)&&("string"==typeof t||t instanceof String)}function o(t){return void 0!==t}function s(t){return o(t)&&null!==t}!function(t){t[t.TAP=0]="TAP",t[t.LONG_PRESS=1]="LONG_PRESS",t[t.DRAG=2]="DRAG",t[t.FLICK=3]="FLICK",t[t.PINCH_IN=4]="PINCH_IN",t[t.PINCH_OUT=5]="PINCH_OUT"}(t||(t={})),function(t){t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(e||(e={})),function(t){t[t.PAGE_VIEW=4]="PAGE_VIEW",t[t.TAP=6]="TAP",t[t.LONG_PRESS=8]="LONG_PRESS",t[t.DRAG=9]="DRAG",t[t.FLICK=10]="FLICK"}(n||(n={}));var c=function(){function e(t){this.bridge=t}return e.prototype.sendPageView=function(t){i(t.url)&&this.bridge.sendEvent(this.buildEvent(n.PAGE_VIEW,t))},e.prototype.sendGesture=function(e,r){var i=t[e];this.bridge.sendEvent(this.buildEvent(n[i],r))},e.prototype.sendDynamicVar=function(t){var e=t.key,n=t.value;this.bridge.sendDynamicVar(e,n)},e.prototype.sendTransaction=function(t,e,n){this.bridge.sendTransaction(t,e,n)},e.prototype.optIn=function(){this.bridge.optIn()},e.prototype.optOut=function(){this.bridge.optOut()},e.prototype.buildEvent=function(t,e){return{type:t,data:e,version:1}},e}(),a=function(){function t(t,e){this.key=t.slice(0,512),this.value=i(e)?e.slice(0,255):e}return t.isValid=function(t,e){return i(t)&&(i(e)||function(t){return t===parseInt(t,10)}(e))},t}(),u=function(){function t(t,e,n){var r=this;this.event=t,this.commands=e,this.pii=n,this.commands.register("trackDynamicVariable",(function(t){var e=void 0===t?{}:t,n=e.key,i=e.value;a.isValid(n,i)&&r.event.sendDynamicVar(new a(r.pii.anonymize(n),r.pii.anonymize(i)))}))}return t.prototype.start=function(){},t}(),p=function(){function t(t,e){var n=this;this.event=t,this.commands=e,this.commands.register("trackPageview",(function(t){n.event.sendPageView({url:t})}))}return t.prototype.start=function(){},t}(),h=function(t,e){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},h(t,e)},l=function(){return l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},l.apply(this,arguments)};Object.create,Object.create;var d=function(){function t(){}return t.prototype.compute=function(t,e){var n=this.convertPixelsToDPs(e.x)-this.convertPixelsToDPs(t.x),r=this.convertPixelsToDPs(e.y)-this.convertPixelsToDPs(t.y),i=e.time-t.time;return{duration:i,distance:this.computeGestureDistance(n,r),direction:this.computeGestureDirection(n,r),velocity:this.computeGestureVelocity(n,r,i)}},t.prototype.computePinchMetrics=function(t,e){var n=this.convertPixelsToDPs(e.x)-this.convertPixelsToDPs(t.x),r=this.convertPixelsToDPs(e.y)-this.convertPixelsToDPs(t.y);return{duration:e.time-t.time,distance:this.computeGestureDistance(n,r)}},t.prototype.getScale=function(t,e){return Math.abs(e/t-1)},t.prototype.convertPixelsToDPs=function(t){return t/window.devicePixelRatio},t.prototype.computeGestureDistance=function(t,e){return Math.round(Math.sqrt(t*t+e*e))},t.prototype.computeGestureVelocity=function(t,e,n){var r=n/1e3,i=t/r,o=e/r;return Math.round(Math.abs(i)+Math.abs(o))},t.prototype.computeGestureDirection=function(t,n){return Math.abs(t)>Math.abs(n)?t>0?e.RIGHT:e.LEFT:n>0?e.DOWN:e.UP},t}();function f(t){return t.nodeType===Node.ELEMENT_NODE}var m=function(){return void 0!==window.performance&&window.performance.now?window.performance.timing.navigationStart+Math.round(window.performance.now()):Date.now()},y=function(){function e(){this.pinchState={},this.metricsComputer=new d,this.reset()}return e.prototype.onGesture=function(t){this.onGestureCallback=t},e.prototype.isValidTouchEvent=function(t){return"touches"in t&&"changedTouches"in t},e.prototype.processActionDown=function(t){if(this.isValidTouchStart(t)){this.isGestureStart(t)&&this.reset();var e={x:t.touches[0].clientX,y:t.touches[0].clientY,time:m()};if(1===t.touches.length)this.pinchState.startPinchTime=e.time,this.pinchState.firstTouch=e;else if(2===t.touches.length&&(this.pinchState.secondTouch={x:t.touches[1].clientX,y:t.touches[1].clientY,time:m()},this.pinchState.firstTouch&&this.pinchState.secondTouch)){var n=this.metricsComputer.computePinchMetrics(this.pinchState.firstTouch,this.pinchState.secondTouch);this.pinchInitialDistance=n.distance}this.pendingInputs.push(e),this.target=function(t){var e=t.target;return e&&f(e)&&e.shadowRoot&&t.composedPath?t.__csOriginalTarget||t.composedPath()[0]:e}(t)}},e.prototype.processActionMove=function(){this.hasMove=!0},e.prototype.processActionUp=function(t){if(this.isValidTouchEnd(t)){if(this.pendingInputs.push({x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY,time:m()}),this.isSecondFingerRaisedAfterPinch(t)&&this.pinchState.startPinchTime){var e={x:t.touches[0].clientX,y:t.touches[0].clientY,time:this.pinchState.startPinchTime},n={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY,time:m()};this.pinchState.firstTouch&&(this.pinchState.firstTouch=e,this.pinchState.secondTouch=n),this.triggerPinchGesture(t)}this.pinchInitialDistance||this.isValidSingleTouchGesture()&&this.runDetection(t)}},e.prototype.reset=function(){this.pendingInputs=[],this.target=null,this.hasMove=!1,this.pinchInitialDistance=null},e.prototype.runDetection=function(t){var e=this.metricsComputer.compute(this.pendingInputs[0],this.pendingInputs[1]),n=this.hasMove?this.computeSwipeGesture(e):this.computePressGesture(e);this.onGestureCallback(n,t)},e.prototype.triggerPinchGesture=function(t){if(this.pinchState.firstTouch&&this.pinchState.secondTouch){var e=this.metricsComputer.computePinchMetrics(this.pinchState.firstTouch,this.pinchState.secondTouch),n=this.computePinchGesture(e);n&&this.onGestureCallback(n,t)}},e.prototype.computePinchGesture=function(e){if(this.pinchInitialDistance&&!(this.metricsComputer.getScale(this.pinchInitialDistance,e.distance)<.1))return{type:this.pinchInitialDistance>e.distance?t.PINCH_IN:t.PINCH_OUT,target:this.target,distance:e.distance}},e.prototype.computeSwipeGesture=function(e){return{type:e.velocity<100?t.DRAG:t.FLICK,target:this.target,velocity:e.velocity,distance:e.distance,direction:e.direction}},e.prototype.computePressGesture=function(e){return{type:e.duration<1e3?t.TAP:t.LONG_PRESS,target:this.target}},e.prototype.isGestureStart=function(t){return 1===t.touches.length},e.prototype.isValidSingleTouchGesture=function(){return 2===this.pendingInputs.length},e.prototype.isValidTouchStart=function(t){return t.touches.length>0},e.prototype.isValidTouchEnd=function(t){return t.changedTouches.length>0},e.prototype.isSecondFingerRaisedAfterPinch=function(t){return this.hasMove&&!!this.pinchInitialDistance&&1===t.changedTouches.length&&1===t.touches.length},e}(),v=function(e){function n(t){var n=e.call(this)||this;return n.logger=t,n.eventHandlers=[{boundElement:document,type:"touchstart",listener:function(t){return n.processEvent(t)}},{boundElement:document,type:"touchmove",listener:function(t){return n.processEvent(t)}},{boundElement:document,type:"touchend",listener:function(t){return n.processEvent(t)}}],n.detector=new y,n.detector.onGesture((function(t,e){return n.processGesture(t,e)})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,e),n.prototype.processGesture=function(t,e){for(var n in this.subscriptions)(0,this.subscriptions[n])(t,e)},n.prototype.onStartTracking=function(){this.canDetectGesture()&&this.eventHandlers.forEach((function(t){return function(t,e){void 0===e&&(e=!0),t.boundElement.addEventListener(t.type,t.listener,e)}(t)}))},n.prototype.onStopTracking=function(){this.canDetectGesture()&&this.eventHandlers.forEach((function(t){return function(t,e){void 0===e&&(e=!0),t.boundElement.removeEventListener(t.type,t.listener,e)}(t)}))},n.prototype.canDetectGesture=function(){return void 0!==window.devicePixelRatio},n.prototype.processEvent=function(t){var e=this;this.logger.tryToExecute("process gesture event",(function(){if(e.detector.isValidTouchEvent(t))switch(t.type){case"touchstart":e.detector.processActionDown(t);break;case"touchmove":e.detector.processActionMove();break;case"touchend":e.detector.processActionUp(t)}}))()},n.isSwipe=function(e){return e.type===t.FLICK||e.type===t.DRAG},n}(function(){function t(){this.subscriptions={}}return t.prototype.subscribe=function(t,e){this.subscriptions[t]=e,1===Object.keys(this.subscriptions).length&&this.onStartTracking()},t.prototype.unsubscribe=function(t){delete this.subscriptions[t],0===Object.keys(this.subscriptions).length&&this.onStopTracking()},t}());function g(t,e){var n=N(t.localName.toLowerCase());return e?n.replace(e,"$1".concat("-static")):n}function N(t){return t.replace(/([#;&,.+*~':"!^$[\]()<=>|/%?@`{}\\ ])/g,"\\$1")}var E="detached";function T(t){for(var e=t,n=[e];null!==e.parentNode;)e=e.parentNode,n.push(e);return w(e)&&n.push(E),{ancestors:n,selectionRoot:e}}function w(t){return z.isValidElement(t)}var S=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector;function b(t,e){return!!e&&e.some((function(e){return S.call(t,e)}))}var z,I=[/\d{4}/,/^ember\d+$/],C="data-cs-override-id";function D(t){return t.getAttribute(C)}function A(t,e,n){try{return 1===n.querySelectorAll("[".concat(t,'="').concat(e,'"]')).length}catch(t){if("SyntaxError"!==t.name)throw t}return!1}function P(t,e){try{return 1===e.querySelectorAll(t).length}catch(t){if("SyntaxError"!==t.name)throw t}return!1}function R(t,e,n){var r=t.shift();if(0===t.length)return _(r,n);var i=function(t,e,n,r){var i=r.dynamicIdRegex||null,o=g(t,r.dynamicElementNameRegex);if(function(t,e){var n=D(t);return n&&n.match(/^[\w-]+$/)&&A(C,n,e)}(t,n)){var s=D(t);return{hasUniqueIdentifier:!0,elementSelector:"".concat(o,"[").concat(C,'="').concat(s,'"]')}}var c=function(t,e,n){if(!n.uniqueAttributes)return{success:!1};for(var r=0,i=n.uniqueAttributes;r<i.length;r++){var o=i[r],s=t.getAttribute(o);if(null!==s&&A(o,s,e))return{attributeName:o,attributeValue:s,success:!0}}return{success:!1}}(t,n,r);if(c.success)return{hasUniqueIdentifier:!0,elementSelector:"".concat(o,"#UA[").concat(c.attributeName,'="').concat(c.attributeValue,'"]')};var a=function(t,e,n){if(n.uniqueCssSelectors)for(var r=0,i=n.uniqueCssSelectors;r<i.length;r++){var o=i[r];if(S.call(t,o)&&P(o,e))return o}}(t,n,r);if(a)return{hasUniqueIdentifier:!0,elementSelector:"".concat(o,"#UCS[").concat(a,"]")};var u=function(t){var e=t.getAttribute("id");return e?N(e):e}(t);if(function(t,e,n,r){return e&&!function(t){return null!==D(t)}(t)&&!function(t,e,n){return t.hasAttribute("data-cs-dynamic-id")||function(t,e){var n=!1;return t&&e&&(n=e.test(t)),t&&(I.some((function(e){return e.test(t)}))||n)}(e,n)}(t,e,r)&&function(t,e){return t&&A("id",t,e)}(e,n)}(t,u,n,i))return{hasUniqueIdentifier:!0,elementSelector:"".concat(o,"#").concat(u)};var p=function(t,e){if(e.reliableSelectors)for(var n=0,r=e.reliableSelectors;n<r.length;n++){var i=r[n];if(S.call(t,i))return i}}(t,r);if(p){var h=function(t,e,n){if(t===E||9===t.nodeType)return 0;for(var r=0,i=e.previousElementSibling;i;)S.call(i,n)&&(r+=1),i=i.previousElementSibling;return r}(e,t,p);return{hasUniqueIdentifier:!1,elementSelector:"".concat(o,"[").concat(p,"](").concat(h,")")}}var l=function(t,e,n){if(t===E||9===t.nodeType)return 0;for(var r=n.dynamicElementNameRegex,i=g(e,r),o=0,s=e.previousElementSibling;s;)g(s,r)!==i||b(s,n.reliableSelectors)||(o+=1),s=s.previousElementSibling;return o}(e,t,r);return{hasUniqueIdentifier:!1,elementSelector:"".concat(o,":eq(").concat(l,")")}}(r,t[0],e,n),o=i.elementSelector,s=i.hasUniqueIdentifier;if(!n.fullPath&&s){var c=t[t.length-1];return"".concat(_(c,n)).concat(o)}var a=R(t,e,n);return"".concat(a?"".concat(a,">"):"").concat(o)}function _(t,e){if(t===E)return"|detached|";if(t.host){var n=T(t.host),r=n.ancestors,i=n.selectionRoot;return"".concat(R(r,i,e),"|shadow-root|")}return 11===t.nodeType?"|fragment|":""}!function(t){function e(t){return!!t&&"localName"in t&&"getAttribute"in t&&"hasAttribute"in t&&"parentNode"in t}function n(t){return t&&"jquery"in t&&1===t.length?t[0]:t}t.INVALID_ELEMENT="INVALID_ELEMENT",t.isValidElement=e,t.getElementPath=function(r,i){void 0===i&&(i={fullPath:!1,dynamicIdRegex:null});var o=n(r);if(o===document)return"";if(!e(o))return t.INVALID_ELEMENT;var s=T(o);return R(s.ancestors,s.selectionRoot,i)},t.getElementPathAndFirstAnchorParent=function(r,i){void 0===i&&(i={fullPath:!1,dynamicIdRegex:null});var o=n(r);if(o===document)return{path:"",firstAnchorParent:null};if(!e(o))return{path:t.INVALID_ELEMENT,firstAnchorParent:null};var s=function(t){for(var e,n=t,r=[n],i=null;null!==n.parentNode;)null===i&&f(e=n)&&"a"===e.localName&&(i=n),r.push(n.parentNode),n=n.parentNode;return w(n)&&r.push(E),{firstAnchorParent:i,ancestors:r,selectionRoot:n}}(o),c=s.firstAnchorParent;return{path:R(s.ancestors,s.selectionRoot,i),firstAnchorParent:c}}}(z||(z={}));var x,O=function(){function t(t,e,n){this.event=t,this.gestureTracker=e,this.pathComputation=n}return t.prototype.start=function(){var e=this;this.gestureTracker.subscribe(t.TRACKER_IDENTIFIER,(function(t){return e.processGesture(t)}))},t.prototype.processGesture=function(t){var e=this.pathComputation.getElementPath(t.target);if(e!==z.INVALID_ELEMENT){var n=v.isSwipe(t)?{path:e,direction:t.direction,distance:t.distance,velocity:t.velocity}:{path:e};this.event.sendGesture(t.type,n)}},t.TRACKER_IDENTIFIER="WebViewGestureTracker",t}(),G=/[a-zA-Z0-9._%+-]+(?:@|%40)[a-zA-Z0-9.%-_]+((?:\.|%2[eE])[a-zA-Z0-9-]+)+/g,M=/[a-zA-Z0-9+_-](?:@|%40)/,k=function(){function t(){}return t.prototype.anonymize=function(t){return"string"==typeof t&&M.test(t)?t.replace(G,"CS_ANONYMIZED_EMAIL"):t},t.prototype.anonymizeFields=function(t,e){var n=this;return e.forEach((function(e){t[e]=n.anonymize(t[e])})),t},t}(),V=function(){function t(t,e){var n=this;this.event=t,this.commands=e,this.commands.register("optin",(function(){return n.event.optIn()}))}return t.prototype.start=function(){},t}(),L=function(){function t(t,e){var n=this;this.event=t,this.commands=e,this.commands.register("optout",(function(){return n.event.optOut()}))}return t.prototype.start=function(){},t}(),U=function(){function t(t,e,n){var r=this;this.event=t,this.commands=e,this.pii=n,this.commands.register("trackTransaction",(function(t){var e=t.value,n=t.currency,c=t.id;(function(t){return o(t)&&("number"==typeof t||t instanceof Number)&&!isNaN(t)})(e)&&i(n)&&n.length<=10&&(!s(c)||i(c))&&r.event.sendTransaction(s(c)?r.pii.anonymize(c):null,e,n)}))}return t.prototype.start=function(){},t}(),F=function(){function t(t,e,n){this.bridge=t,this.logger=e,this.commands=n;var r=new c(this.bridge),i=new k;this.dynamicVarTracker=new u(r,this.commands,i),this.pageViewTracker=new p(r,this.commands),this.gestureTracker=new O(r,new v(this.logger),z),this.optInTracker=new V(r,this.commands),this.optOutTracker=new L(r,this.commands),this.transactionTracker=new U(r,this.commands,i)}return t.prototype.start=function(){this.dynamicVarTracker.start(),this.pageViewTracker.start(),this.gestureTracker.start(),this.optInTracker.start(),this.optOutTracker.start(),this.transactionTracker.start()},t}();function q(t){for(var e=t.length,n=new Array(e),r=0;r<e;r+=1)n[r]=t[r];return n}!function(t){t[t.WebElement=0]="WebElement",t[t.MobileView=1]="MobileView",t[t.WebViewContainer=2]="WebViewContainer"}(x||(x={}));var B,J=function(){function t(t){this.processors=t}return t.prototype.serialize=function(t,e){void 0===e&&(e={});var n,r=l({},e),i=t.nodeType;switch(i){case Node.ELEMENT_NODE:n=this.serializeElementNode(t,r);break;case Node.TEXT_NODE:n=this.serializeTextNode(t,r);break;case Node.CDATA_SECTION_NODE:n=this.serializeCDATASectionNode(t,r);break;case Node.COMMENT_NODE:n=this.serializeCommentNode(t,r);break;case Node.DOCUMENT_TYPE_NODE:n=this.serializeDoctypeNode(t,r);break;case Node.DOCUMENT_NODE:n=this.serializeDocumentNode(t,r);break;case Node.DOCUMENT_FRAGMENT_NODE:n=this.serializeDocumentFragmentNode(t,r);break;default:throw new Error("serialization is not supported (nodeType: ".concat(i,")"))}return this.processors.reduce((function(e,n){return n.afterSerialize?n.afterSerialize(t,e,r):e}),n)},t.prototype.serializeElementNode=function(t,e){var n,r=this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeElementNode?r.serializeElementNode(t,i,e):i}),{attributes:[]});(n=r.attributes).push.apply(n,this.serializeAttributes(t,e));var i=t.shadowRoot;return i&&(r.shadowRoot=this.serializeShadowRootNode(i,e)),r.children=this.serializeChildren(t,e),r},t.prototype.serializeAttributes=function(t,e){var n=this,r=q(t.attributes);return this.processors.reduce((function(n,r){return r.beforeSerializeAttributes?r.beforeSerializeAttributes(t,n,e):n}),r).map((function(r){return n.serializeAttribute(t,r,e)}))},t.prototype.serializeAttribute=function(t,e,n){return this.processors.reduce((function(r,i){return i.serializeAttribute?i.serializeAttribute(t,e,r,n):r}),{})},t.prototype.runBeforeSerializeChildrenHook=function(t,e){var n=e.excludedNodes?function(t,n){for(var r=t.length,i=[],o=0;o<r;o+=1){var s=t[o];c=s,!e.excludedNodes.get(c)&&i.push(s)}var c;return i}(t.childNodes):q(t.childNodes);return this.processors.reduce((function(n,r){return r.beforeSerializeChildren?r.beforeSerializeChildren(t,n,e):n}),n)},t.prototype.serializeChildren=function(t,e){var n=this;return e.skipChildrenSerialization?[]:this.runBeforeSerializeChildrenHook(t,e).map((function(t){return n.serialize(t,e)}))},t.prototype.serializeTextNode=function(t,e){return this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeTextNode?r.serializeTextNode(t,i,e):i}),{})},t.prototype.serializeCDATASectionNode=function(t,e){return this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeCDATASectionNode?r.serializeCDATASectionNode(t,i,e):i}),{})},t.prototype.serializeCommentNode=function(t,e){return this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeCommentNode?r.serializeCommentNode(t,i,e):i}),{})},t.prototype.serializeDoctypeNode=function(t,e){return this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeDoctypeNode?r.serializeDoctypeNode(t,i,e):i}),{})},t.prototype.serializeDocumentNode=function(t,e){var n=this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeDocumentNode?r.serializeDocumentNode(t,i,e):i}),{});return n.children=this.serializeChildren(t,e),n},t.prototype.serializeShadowRootNode=function(t,e){var n=this.processors.reduce((function(n,r){var i=n;return r.serializeNode&&(i=r.serializeNode(t,n,e)),r.serializeShadowRootNode?r.serializeShadowRootNode(t,i,e):i}),{});return n.children=this.serializeChildren(t,e),this.processors.reduce((function(n,r){return r.afterSerializeShadowRoot?r.afterSerializeShadowRoot(t,n,e):n}),n)},t.prototype.serializeDocumentFragmentNode=function(t,e){if(t.mode)return this.serializeShadowRootNode(t,e);throw new Error("Not implemented yet.")},t}(),H=function(t){return Object.getOwnPropertyDescriptor(t.prototype,"localName")},W=null!==(B=H(Element))&&void 0!==B?B:H(Node),j=function(){function t(){this.inlineCssToRulesCount=new Map,this.virtualDoc=document.implementation.createHTMLDocument("")}return t.prototype.beforeSerializeChildren=function(t,e){if(f(c=t)&&"style"===c.localName){var n=this.getAllCssRules(t);if(null===n||0===n.length)return e;if(this.isEmptyStyleElement(t))e.push(this.createTextNodeFromRules(n));else{var r=this.lengthOfInlineCssRules(t);if(r===n.length)return e;for(var i=new Array(n.length-r),o=r,s=0;o<n.length;o+=1,s+=1)i[s]=n[o];e.push(this.createTextNodeFromRules(i))}}var c;return e},t.prototype.lengthOfInlineCssRules=function(t){var e=this.inlineCssToRulesCount.get(t.textContent);if(e)return e;var n=t.cloneNode(!0);n.textContent=t.textContent,this.virtualDoc.head.appendChild(n);var r=this.getAllCssRules(n);return e=r?r.length:0,this.inlineCssToRulesCount.set(t.textContent,e),this.virtualDoc.head.removeChild(n),e},t.prototype.getAllCssRules=function(t){try{var e=t.sheet;return e?e.cssRules||e.rules:null}catch(t){if("SecurityError"!==t.name&&"InvalidAccessError"!==t.name)throw t;return null}},t.prototype.isEmptyStyleElement=function(t){var e=t.textContent||"";return/^\s*$/.test(e)},t.prototype.createTextNodeFromRules=function(t){var e="";!function(t,n){for(var r=t.length,i=0;i<r;i++)o=t[i],e+=o.cssText;var o}(t);var n=document.createTextNode(e);return n.__contentsquare_artificial=!0,n},t.prototype.serializeNode=function(t,e){return e.nodeType=t.nodeType,e.format=x.WebElement,t.__contentsquare_artificial&&(e.artificial=t.__contentsquare_artificial),e},t.prototype.serializeElementNode=function(t,e){var n;return e.localName=(n=t,W.get.call(n)),e.namespaceURI=t.namespaceURI,e},t.prototype.serializeAttribute=function(t,e,n){return n.name=e.name,n.value=e.value,n.namespaceURI=null!==e.namespaceURI?e.namespaceURI:"",n},t.prototype.serializeTextNode=function(t,e){return e.data=t.data,e},t.prototype.serializeCDATASectionNode=function(t,e){return e.data=t.data,e},t.prototype.serializeCommentNode=function(t,e){return e.data=t.data,e},t.prototype.serializeDoctypeNode=function(t,e){return e.name=t.name,e.publicId=t.publicId,e.systemId=t.systemId,e},t.prototype.serializeDocumentNode=function(e,n){return n.baseURI=t.getBaseURI(e),n},t.prototype.serializeShadowRootNode=function(t,e){return e.mode=t.mode,e},t.getBaseURI=function(t){var e=t.baseURI;if(null==e){var n=t.getElementsByTagName("base");e=0!==n.length?n[0].href:t.URL}return e},t}(),K=function(){function t(t){this.commands=t;var e=new J([new j]);this.commands.register("serializeWebView",(function(){return JSON.stringify(e.serialize(document))}))}return t.prototype.start=function(){},t}(),Y=function(){function t(t,e,n){this.bridge=t,this.logger=e,this.commands=n,this.eventModule=new F(this.bridge,this.logger,this.commands),this.serializationModule=new K(this.commands)}return t.prototype.start=function(){this.commands.start(),this.eventModule.start(),this.serializationModule.start()},t}(),X=function(){function t(t,e,n){this.bridge=t,this.location=e,this.tagVersion=n}return t.prototype.tryToExecute=function(t,e){var n=this;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{return e.apply(void 0,r)}catch(e){try{n.sendException(t,e)}catch(t){}}}},t.prototype.log=function(t){this.bridge.sendMessage({message:t})},t.prototype.sendException=function(t,e){this.bridge.sendException({url:this.location.href,tagVersion:this.tagVersion,message:"".concat(t," - ").concat(this.getErrorMessageAndStack(e)),timestamp:Date.now()})},t.prototype.getErrorMessageAndStack=function(t){return(t.message?t.message:t.toString())+" "+(t.stack?t.stack:t.toString())},t}(),$=function(){function t(t){this.logger=t,this.registry={}}return t.prototype.register=function(t,e){this.registry[t]=e},t.prototype.start=function(){this.applyPending(),this.enableImmediateApplication()},t.prototype.applyPending=function(){var t=this;window.cs_wvt.forEach((function(e){var n=e[0],r=e.slice(1);t.apply(n,r)}))},t.prototype.enableImmediateApplication=function(){var t=this;window.cs_wvt={push:function(e){var n=e[0],r=e.slice(1);return t.apply(n,r)}}},t.prototype.apply=function(t,e){var n=this;return this.logger.tryToExecute("Commands.apply",(function(){var r;if(n.registry[t])return(r=n.registry)[t].apply(r,e)}))()},t}(),Z=new r,Q=new X(Z,window.location,"dev");Z.whenReady(Q.tryToExecute("init",(function(){window.cs_wvt=window.cs_wvt||[];var t=new $(Q);new Y(Z,Q,t).start(),Q.log("ready, v:".concat("dev"))})))})();